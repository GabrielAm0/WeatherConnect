import{useFrame as r}from"@studio-freight/hamo";import e from"@studio-freight/lenis";import t from"clsx";import o from"prop-types";import a,{createContext as n,useEffect as c,forwardRef as s,useRef as l,useState as i,useCallback as u,useImperativeHandle as f,useContext as m}from"react";import{create as p}from"zustand";function d(){return d=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},d.apply(this,arguments)}const b=n(),y=p((()=>({})));function h(r,e=[],t=0){const{lenis:o,addCallback:a,removeCallback:n}=function(){const r=m(b),e=y();return r??e}();return c((()=>{if(r&&a&&n&&o)return a(r,t),r(o),()=>{n(r)}}),[o,a,n,t,...e]),o}const v=s((({children:o,root:n=!1,options:s={},autoRaf:m=!0,rafPriority:p=0,className:h,...v},g)=>{const N=l(),k=l(),[C,O]=i(),j=l([]),w=u(((r,e)=>{j.current.push({callback:r,priority:e}),j.current.sort(((r,e)=>r.priority-e.priority))}),[]),P=u((r=>{j.current=j.current.filter((e=>e.callback!==r))}),[]);f(g,(()=>({wrapper:N.current,content:k.current,lenis:C})),[C]),c((()=>{const r=new e({...s,...!n&&{wrapper:N.current,content:k.current}});return O(r),()=>{r.destroy(),O(void 0)}}),[n,JSON.stringify(s)]),r((r=>{m&&C?.raf(r)}),p),c((()=>{n&&C&&y.setState({lenis:C,addCallback:w,removeCallback:P})}),[n,C,w,P]);const E=u((r=>{for(let e=0;e<j.current.length;e++)j.current[e].callback(r)}),[]);c((()=>(C?.on("scroll",E),()=>{C?.off("scroll",E)})),[C,E]);const R=u((()=>{N.current&&(N.current.className=t(C?.className,h))}),[C,h]);return c((()=>(R(),C?.on("className change",R),()=>{C?.off("className change",R)})),[C,R]),a.createElement(b.Provider,{value:{lenis:C,addCallback:w,removeCallback:P}},n?o:a.createElement("div",d({ref:N,className:t(C?.className,h)},v),a.createElement("div",{ref:k},o)))}));v.displayName="ReactLenis",v.propTypes={children:o.node,root:o.bool,options:o.object,autoRaf:o.bool,rafPriority:o.number,className:o.string};export{v as Lenis,b as LenisContext,v as ReactLenis,v as default,h as useLenis};
//# sourceMappingURL=react-lenis.mjs.map
